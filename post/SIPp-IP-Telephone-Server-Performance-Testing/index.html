
 <!DOCTYPE HTML>
<html lang="en-us">
<head>
  <meta charset="UTF-8">
  
    <title>使用SIPp对基于SIP协议的IP电话通信服务器进行性能测试 | DebugTalk</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="九毫">
    

    
    <meta name="description" content="背景知识介绍IP电话IP电话是指在IP网络上打电话。所谓“IP网络”就是“使用IP协议的分组交换网”的简称。常见的IP电话有VoIP（Voice over IP），Internet Telephony 和 VON（Voice over Net）。 IP电话网关IP电话网关（IP Telepathy Gateway），是公用电话网（即公用电路交换电话网，又称传统电话网或电信网）与IP网络的接口设备，">
<meta name="keywords" content="性能测试,SIP">
<meta property="og:type" content="article">
<meta property="og:title" content="使用SIPp对基于SIP协议的IP电话通信服务器进行性能测试">
<meta property="og:url" content="http://debugtalk.com/post/SIPp-IP-Telephone-Server-Performance-Testing/index.html">
<meta property="og:site_name" content="DebugTalk">
<meta property="og:description" content="背景知识介绍IP电话IP电话是指在IP网络上打电话。所谓“IP网络”就是“使用IP协议的分组交换网”的简称。常见的IP电话有VoIP（Voice over IP），Internet Telephony 和 VON（Voice over Net）。 IP电话网关IP电话网关（IP Telepathy Gateway），是公用电话网（即公用电路交换电话网，又称传统电话网或电信网）与IP网络的接口设备，">
<meta property="og:locale" content="en-us">
<meta property="og:image" content="http://debugtalk.com/images/20140511201122_SIP_Simple_Session.png">
<meta property="og:image" content="http://debugtalk.com/images/20140511201122_SIPp_Operating_Principle.jpg">
<meta property="og:image" content="http://debugtalk.com/images/20140511201122_XML_Invoke_CSV.jpg">
<meta property="og:image" content="http://debugtalk.com/images/20140511201122_Network_Topology_Map.gif">
<meta property="og:updated_time" content="2017-09-04T05:28:54.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用SIPp对基于SIP协议的IP电话通信服务器进行性能测试">
<meta name="twitter:description" content="背景知识介绍IP电话IP电话是指在IP网络上打电话。所谓“IP网络”就是“使用IP协议的分组交换网”的简称。常见的IP电话有VoIP（Voice over IP），Internet Telephony 和 VON（Voice over Net）。 IP电话网关IP电话网关（IP Telepathy Gateway），是公用电话网（即公用电路交换电话网，又称传统电话网或电信网）与IP网络的接口设备，">
<meta name="twitter:image" content="http://debugtalk.com/images/20140511201122_SIP_Simple_Session.png">

    
    <link rel="alternative" href="/atom.xml" title="DebugTalk" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="DebugTalk" title="DebugTalk"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="DebugTalk">DebugTalk</a></h1>
				<h2 class="blog-motto">探索一个软件工程师的无限可能</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:debugtalk.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/post/SIPp-IP-Telephone-Server-Performance-Testing/" title="使用SIPp对基于SIP协议的IP电话通信服务器进行性能测试" itemprop="url">使用SIPp对基于SIP协议的IP电话通信服务器进行性能测试</a>
  </h1>
  <!-- <p class="article-author">By
       
		<a href="/about" title="九毫" target="_blank" itemprop="author">九毫</a>
		 -->
  <p class="article-time">
    <time datetime="2014-05-10T16:00:00.000Z" itemprop="datePublished"> Published 2014-05-11</time>
    
    <span id="busuanzi_container_page_pv">
      | 本文总阅读量<span id="busuanzi_value_page_pv"></span>次
    </span>
    
  </p>
</header>

	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#背景知识介绍"><span class="toc-number">1.</span> <span class="toc-text">背景知识介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IP电话"><span class="toc-number">1.1.</span> <span class="toc-text">IP电话</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IP电话网关"><span class="toc-number">1.2.</span> <span class="toc-text">IP电话网关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IP电话所需要的几种应用协议"><span class="toc-number">1.3.</span> <span class="toc-text">IP电话所需要的几种应用协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SIP协议"><span class="toc-number">1.4.</span> <span class="toc-text">SIP协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SIPp工具介绍"><span class="toc-number">2.</span> <span class="toc-text">SIPp工具介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SIPp软件简介"><span class="toc-number">2.1.</span> <span class="toc-text">SIPp软件简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SIPp的安装（Windows）"><span class="toc-number">2.2.</span> <span class="toc-text">SIPp的安装（Windows）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SIPp的工作原理"><span class="toc-number">2.3.</span> <span class="toc-text">SIPp的工作原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SIPp的常用工作模式"><span class="toc-number">2.4.</span> <span class="toc-text">SIPp的常用工作模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SIPp的使用"><span class="toc-number">3.</span> <span class="toc-text">SIPp的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SIPp的配置文件"><span class="toc-number">3.1.</span> <span class="toc-text">SIPp的配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uac-xml"><span class="toc-number">3.2.</span> <span class="toc-text">uac.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#data-csv"><span class="toc-number">3.3.</span> <span class="toc-text">data.csv</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uac-bat"><span class="toc-number">3.4.</span> <span class="toc-text">uac.bat</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用SIPp对基于SIP协议的网络电话进行性能测试"><span class="toc-number">4.</span> <span class="toc-text">使用SIPp对基于SIP协议的网络电话进行性能测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#测试内容"><span class="toc-number">4.1.</span> <span class="toc-text">测试内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试场景分析"><span class="toc-number">4.2.</span> <span class="toc-text">测试场景分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试方法"><span class="toc-number">4.3.</span> <span class="toc-text">测试方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试步骤"><span class="toc-number">4.4.</span> <span class="toc-text">测试步骤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考资料"><span class="toc-number">5.</span> <span class="toc-text">参考资料</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#附录"><span class="toc-number">6.</span> <span class="toc-text">附录</span></a></li></ol>
		
		</div>
		
		<h2 id="背景知识介绍"><a href="#背景知识介绍" class="headerlink" title="背景知识介绍"></a>背景知识介绍</h2><h3 id="IP电话"><a href="#IP电话" class="headerlink" title="IP电话"></a>IP电话</h3><p>IP电话是指在IP网络上打电话。所谓“IP网络”就是“使用IP协议的分组交换网”的简称。<br>常见的IP电话有VoIP（Voice over IP），Internet Telephony 和 VON（Voice over Net）。</p>
<h3 id="IP电话网关"><a href="#IP电话网关" class="headerlink" title="IP电话网关"></a>IP电话网关</h3><p>IP电话网关（IP Telepathy Gateway），是公用电话网（即公用电路交换电话网，又称传统电话网或电信网）与IP网络的接口设备，其作用包含两个方面：</p>
<ul>
<li>在电话呼叫阶段和呼叫释放阶段进行电话信令的转换</li>
<li>在通话期间进行话音编码的转换</li>
</ul>
<p>IP电话网关的出现，实现了PC机用户之间的IP电话通话（无需经过IP电话网关），PC机用户与固定电话用户的IP电话通话（仅需经过IP电话网关1次），以及固定电话用户之间的IP电话通话（需要经过IP电话网关2次）。</p>
<h3 id="IP电话所需要的几种应用协议"><a href="#IP电话所需要的几种应用协议" class="headerlink" title="IP电话所需要的几种应用协议"></a>IP电话所需要的几种应用协议</h3><p>在IP电话的通信中，至少需要两种应用协议，即信令协议和传送协议。<br>其中，<strong>信令协议</strong>的作用是帮助主叫者在因特网上找到被叫用户。在公用电话网中，电话交换机根据用户所拨打的号码就能够通过合适的路由找到被叫用户，并在主叫和被叫之间建立一条电路连接。这些都是依靠电话信令（Signaling）实现的。我们听到的振铃音、忙音或一些录音提示，以及打完电话挂机释放连接，都是由电话信令来处理的。现在电话网使用的信令是7号信令SS7。利用IP网络打电话同样也需要IP网络能够识别某种信令。但由于IP电话往往要经过已有的公用电话网，因此IP电话的信令必须在功能上与原有的7号信令相兼容，这样才能使IP网络和公用电话网上的两种信令能够互相转换，从而做到互操作。现有的与信令有关的协议为H.323和SIP，本文只介绍SIP协议。<br>话音分组的<strong>传送协议</strong>，其作用是使用来进行电话通信的话音数据能够以时延敏感属性在因特网中传送。常见的传送协议为RTP。</p>
<h3 id="SIP协议"><a href="#SIP协议" class="headerlink" title="SIP协议"></a>SIP协议</h3><p>SIP协议，即会话发起协议（Session Initiation Protocol），是使用文本方式的客户服务器协议。<br>SIP系统只有两种构件，即用户代理（user agent）和网络服务器（network server）。<br>用户代理包含两个程序，即用户代理客户端UAC（User Agent Client）和用户代理服务器UAS（User Agent Server）；前者用来发起呼叫，后者用来接受呼叫。<br>网络服务器分为代理服务器（proxy server）和重定向服务器（redirect server）。代理服务器接受来自主叫用户的呼叫请求（实际上是来自用户代理客户端UAC的呼叫请求），并将其转发给被叫用户或下一跳代理服务器；若转发给下一跳代理服务器，则下一跳代理服务器再把呼叫请求转发给被叫用户（实际上是转发给用户代理服务器UAS）。重定向服务器不接受呼叫，它通过响应告诉客户下一跳代理服务器的地址，由客户按此地址向下一跳代理服务器重新发送呼叫请求。<br>SIP的会话共有三个阶段：建立会话、通信和终止会话。图1给出了一个简单的SIP会话的例子。其中建立会话阶段和终止会话阶段都是使用SIP协议，而中间的通信阶段是使用如RTP这样的传送实时话音分组的协议。</p>
<p>{: .center}<br><img src="/images/20140511201122_SIP_Simple_Session.png" alt="SIP_Simple_Session"><br>图1 SIP的简单会话过程</p>
<p>在图1中，主叫方（Tesla）先向被叫方（Marconi）发出INVITE报文，这个报文中含有双方的地址信息以及一些其它信息（如通话时话音编码方式等）；被叫方收到请求后，会返回180 Ringing的状态码，并处于振铃状态；若被叫方接受呼叫请求，则返回200 OK的状态码；主叫方再发送ACK报文作为确认（类似于TCP建立连接时的三次握手），然后双方便完成连接，可以进行通话了；通话过程中，双方中的任何一方都可以发送BYE报文以终止会话。如上便是SIP会话的全过程。</p>
<h2 id="SIPp工具介绍"><a href="#SIPp工具介绍" class="headerlink" title="SIPp工具介绍"></a>SIPp工具介绍</h2><h3 id="SIPp软件简介"><a href="#SIPp软件简介" class="headerlink" title="SIPp软件简介"></a>SIPp软件简介</h3><p>如下是SIPp官方网站上关于SIPp的介绍。</p>
<blockquote>
<p>SIPp is a free Open Source test tool / traffic generator for the SIP protocol. It includes a few basic SipStone user agent scenarios (UAC and UAS) and establishes and releases multiple calls with the INVITE and BYE methods. It can also reads custom XML scenario files describing from very simple to complex call flows. It features the dynamic display of statistics about running tests (call rate, round trip delay, and message statistics), periodic CSV statistics dumps, TCP and UDP over multiple sockets or multiplexed with retransmission management and dynamically adjustable call rates.<br>SIPp can be used to test various real SIP equipment like SIP proxies, B2BUAs, SIP media servers, SIP/x gateways, SIP PBX, … It is also very useful to emulate thousands of user agents calling your SIP system.</p>
</blockquote>
<h3 id="SIPp的安装（Windows）"><a href="#SIPp的安装（Windows）" class="headerlink" title="SIPp的安装（Windows）"></a>SIPp的安装（Windows）</h3><p>SIPp几乎可以运行在所有UNIX平台上，HPUX、Tru64、Linux (RedHat, Debian, FreeBSD)和Solaris/SunOS。并且，SIPp已被移植到Windows平台。</p>
<ul>
<li>在Linux/Unix平台上，SIPp采用源代码的形式进行提供，需要通过编译源代码的方式进行安装。</li>
<li>在Windows平台上，SIPp提供了预编译的可执行文件，可以直接进行安装；也可以通过在Windows系统中安装CYGWIN模拟Linux环境，然后通过编译源代码的方式进行安装。</li>
</ul>
<p>通常情况下，在Windows平台中通过预编译可执行文件可以快速完成安装，操作简单且成功率高，但该种方式存在局限性，主要有如下几点：</p>
<ul>
<li>Windows预编译版本的功能存在删减，不支持PCAP（语音）和密码验证功能；</li>
<li>Windows的预编译版本较为滞后，例如当前SIPp的最新版本为3.4，而Windows的最新预编译版本为3.2；</li>
<li>相比于Linux/Unix平台，SIPp在Windows平台上运行不够稳定，特别是并发量较大时可能会出现问题，因此不适宜进行压力测试。</li>
</ul>
<h3 id="SIPp的工作原理"><a href="#SIPp的工作原理" class="headerlink" title="SIPp的工作原理"></a>SIPp的工作原理</h3><p>对于电话而言，每台电话机既是客户端（可拨打电话）也是服务端（可接听电话）。同理，SIPp模拟用户代理，也有两种工作模式：UAC和UAS。</p>
<p>SIPp中具有场景（scenario）的概念，它是一个XML格式的文件，其作用是用来描述SIP协议通讯过程。具体地，UAC和UAS分别对应一个场景文件：uac.xml用于描述客户端的呼叫，uas.xml用于描述服务端的响应。在SIPp工具中，已经内置了许多场景文件，可直接使用；测试人员也可参照场景文件的格式要求，自定义编写场景文件。</p>
<p>另外，SIPp采用了数据与场景分离的设计，从而使工具的使用更加灵活。其中，数据包括IP地址、端口号、电话号码、用户名等内容。通常，测试数据保存在CSV文件中，如data.csv。</p>
<p>SIPp是通过命令行的方式操作调用的。例如，在利用SIPp模拟UAC发起呼叫时，可在cmd窗口中运行如下命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sipp -sn uac 172.31.89.4:5060 -r 1 -rp 3000 -inf data.csv -p 7098 -i 172.31.89.242 -s 8001 -sf uac_onecall.xml –m 1000 –l 900</div></pre></td></tr></table></figure></p>
<p>可以看出，如果每次都在命令行中输入命令进行运行，效率将十分低下；因此，可以将配置好的命令保存在bat批处理文件中，方便测试时直接调用。</p>
<h3 id="SIPp的常用工作模式"><a href="#SIPp的常用工作模式" class="headerlink" title="SIPp的常用工作模式"></a>SIPp的常用工作模式</h3><p>SIPp具有三种常用工作模式：</p>
<ul>
<li>当SIPp作为UAC时，可向已有电话终端（电话机或运行在电脑上的虚拟终端）发起呼叫；</li>
<li>当SIPp作为UAS时，可接收到现有电话终端（电话机或运行在电脑上的虚拟终端）发起的呼叫；</li>
<li>SIPp还可同时作为UAC和UAS，并使用UAC向UAS发起呼叫，以此来对代理服务器进行测试。</li>
</ul>
<p>图2是对第三种模式的描述。</p>
<p>{: .center}<br><img src="/images/20140511201122_SIPp_Operating_Principle.jpg" alt="SIPp_Operating_Principle"><br>图2 SIPp工作原理</p>
<p>在该种模式下，需先运行服务端UAS，然后再运行客户端UAC。接下来，UAC便参照uac.xml场景文件的描述，发起呼叫；而UAS则参照uas.xml场景文件的描述，对呼叫进行响应；整个通讯过程遵循SIP协议，在本文的1.4节已经进行了介绍。</p>
<h2 id="SIPp的使用"><a href="#SIPp的使用" class="headerlink" title="SIPp的使用"></a>SIPp的使用</h2><h3 id="SIPp的配置文件"><a href="#SIPp的配置文件" class="headerlink" title="SIPp的配置文件"></a>SIPp的配置文件</h3><p>通过本文2.3节的介绍可知，使用SIPp时会涉及到5个文件：uac.xml, uas.xml, data.csv, uac.bat, uas.bat。</p>
<p>其用途简要说明如下：</p>
<ul>
<li>uac.xml：用于描述客户端UAC的SIP信号流程；</li>
<li>uas.xml：用于描述服务端UAS的SIP信号流程；</li>
<li>data.csv：存储数据的文件，方便在uac.xml和uas.xml中引入的相应数据；</li>
<li>uac.bat：存储SIPp命令及参数，便于执行时直接调用，模拟UAC的呼叫；</li>
<li>uas.bat：存储SIPp命令及参数，便于执行时直接调用，模拟UAS的响应。</li>
</ul>
<p>由于uac.xml和uas.xml类似，uac.bat和uas.bat类似，本文只对uac.xml、uac.bat和data.csv三个文件进行讲解。</p>
<h3 id="uac-xml"><a href="#uac-xml" class="headerlink" title="uac.xml"></a>uac.xml</h3><p>SIPp默认自带的uac.xml内容如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="ISO-8859-1" ?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE scenario SYSTEM "sipp.dtd"&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">scenario</span> <span class="attr">name</span>=<span class="string">"Basic Sipstone UAC"</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- In client mode (sipp placing calls), the Call-ID MUST be         --&gt;</span></div><div class="line">  <span class="comment">&lt;!-- generated by sipp. To do so, use [call_id] keyword.              --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">send</span> <span class="attr">retrans</span>=<span class="string">"500"</span>&gt;</span></div><div class="line">    &lt;![CDATA[</div><div class="line"></div><div class="line">      INVITE sip:[service]@[remote_ip]:[remote_port] SIP/2.0</div><div class="line">      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]</div><div class="line">      From: sipp &lt;sip:sipp@[local_ip]:[local_port]&gt;;tag=[call_number]</div><div class="line">      To: sut &lt;sip:[service]@[remote_ip]:[remote_port]&gt;</div><div class="line">      Call-ID: [call_id]</div><div class="line">      CSeq: 1 INVITE</div><div class="line">      Contact: sip:sipp@[local_ip]:[local_port]</div><div class="line">      Max-Forwards: 70</div><div class="line">      Subject: Performance Test</div><div class="line">      Content-Type: application/sdp</div><div class="line">      Content-Length: [len]</div><div class="line"></div><div class="line">      v=0</div><div class="line">      o=user1 53655765 2353687637 IN IP[local_ip_type] [local_ip]</div><div class="line">      s=-</div><div class="line">      c=IN IP[media_ip_type] [media_ip]</div><div class="line">      t=0 0</div><div class="line">      m=audio [media_port] RTP/AVP 0</div><div class="line">      a=rtpmap:0 PCMU/8000</div><div class="line"></div><div class="line">    ]]&gt;</div><div class="line">  <span class="tag">&lt;/<span class="name">send</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">recv</span> <span class="attr">response</span>=<span class="string">"100"</span> <span class="attr">optional</span>=<span class="string">"true"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">recv</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">recv</span> <span class="attr">response</span>=<span class="string">"180"</span> <span class="attr">optional</span>=<span class="string">"true"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">recv</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- By adding rrs="true" (Record Route Sets), the route sets         --&gt;</span></div><div class="line">  <span class="comment">&lt;!-- are saved and used for following messages sent. Useful to test   --&gt;</span></div><div class="line">  <span class="comment">&lt;!-- against stateful SIP proxies/B2BUAs.                             --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">recv</span> <span class="attr">response</span>=<span class="string">"200"</span> <span class="attr">rtd</span>=<span class="string">"true"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">recv</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- Packet lost can be simulated in any send/recv message by         --&gt;</span></div><div class="line">  <span class="comment">&lt;!-- by adding the 'lost = "10"'. Value can be [1-100] percent.       --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">send</span>&gt;</span></div><div class="line">    &lt;![CDATA[</div><div class="line"></div><div class="line">      ACK sip:[service]@[remote_ip]:[remote_port] SIP/2.0</div><div class="line">      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]</div><div class="line">      From: sipp &lt;sip:sipp@[local_ip]:[local_port]&gt;;tag=[call_number]</div><div class="line">      To: sut &lt;sip:[service]@[remote_ip]:[remote_port]&gt;[peer_tag_param]</div><div class="line">      Call-ID: [call_id]</div><div class="line">      CSeq: 1 ACK</div><div class="line">      Contact: sip:sipp@[local_ip]:[local_port]</div><div class="line">      Max-Forwards: 70</div><div class="line">      Subject: Performance Test</div><div class="line">      Content-Length: 0</div><div class="line"></div><div class="line">    ]]&gt;</div><div class="line">  <span class="tag">&lt;/<span class="name">send</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- This delay can be customized by the -d command-line option       --&gt;</span></div><div class="line">  <span class="comment">&lt;!-- or by adding a 'milliseconds = "value"' option here.             --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">pause</span>/&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- The 'crlf' option inserts a blank line in the statistics report. --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">send</span> <span class="attr">retrans</span>=<span class="string">"500"</span>&gt;</span></div><div class="line">    &lt;![CDATA[</div><div class="line"></div><div class="line">      BYE sip:[service]@[remote_ip]:[remote_port] SIP/2.0</div><div class="line">      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]</div><div class="line">      From: sipp &lt;sip:sipp@[local_ip]:[local_port]&gt;;tag=[call_number]</div><div class="line">      To: sut &lt;sip:[service]@[remote_ip]:[remote_port]&gt;[peer_tag_param]</div><div class="line">      Call-ID: [call_id]</div><div class="line">      CSeq: 2 BYE</div><div class="line">      Contact: sip:sipp@[local_ip]:[local_port]</div><div class="line">      Max-Forwards: 70</div><div class="line">      Subject: Performance Test</div><div class="line">      Content-Length: 0</div><div class="line"></div><div class="line">    ]]&gt;</div><div class="line">  <span class="tag">&lt;/<span class="name">send</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">recv</span> <span class="attr">response</span>=<span class="string">"200"</span> <span class="attr">crlf</span>=<span class="string">"true"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">recv</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- definition of the response time repartition table (unit is ms)   --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">ResponseTimeRepartition</span> <span class="attr">value</span>=<span class="string">"10, 20, 30, 40, 50, 100, 150, 200"</span>/&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- definition of the call length repartition table (unit is ms)     --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">CallLengthRepartition</span> <span class="attr">value</span>=<span class="string">"10, 50, 100, 500, 1000, 5000, 10000"</span>/&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">scenario</span>&gt;</span></div></pre></td></tr></table></figure>
<p>如该文件所示，UAC首先发送INVITE请求，按照预期，UAC将依次接收100、180和200状态码，然后UAC再次发送ACK进行确认，从而完成通信连接的建立；最后，UAC发送BYE请求，结束通话，从而断开通信连接。</p>
<h3 id="data-csv"><a href="#data-csv" class="headerlink" title="data.csv"></a>data.csv</h3><p>在data.csv文件中，第一行描述数据的读取方式，如顺序读取（SEQUENTIAL）、随机读取（RANDOM），或者自定义方式（USER）。<br>从第二行开始，每行描述一次呼叫时使用的数据；如果每次呼叫时调用的参数有多个，那么就可用分号（”;”）进行分离，并可在XML文件中进行调用，每行的数据从左到右依次为[field0], [field1], …。</p>
<p>csv文件的编写示例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">SEQUENTIAL</div><div class="line">#注释将被忽略</div><div class="line">Sarah;sipphone32</div><div class="line">Bob;sipphone12</div><div class="line">#This line too</div><div class="line">Fred;sipphone94</div></pre></td></tr></table></figure>
<p>XML调用CSV的具体方式如图3所示。</p>
<p>{: .center}<br><img src="/images/20140511201122_XML_Invoke_CSV.jpg" alt="XML_Invoke_CSV"><br>图3 XML调用CSV的原理</p>
<h3 id="uac-bat"><a href="#uac-bat" class="headerlink" title="uac.bat"></a>uac.bat</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sipp -sn uac 172.31.89.4:5060 -r 1 -rp 3000 -inf data.csv -p 7098 -i 172.31.89.242 -s 8001 -sf uac_onecall.xml –m 1000 –l 900</div></pre></td></tr></table></figure>
<p>各个参数说明：</p>
<ul>
<li>172.31.89.4:5060：远端地址和端口（在xml脚本中用[remote_ip]，[remote_port]引用）</li>
<li>-r 1 -rp 3000：每三秒钟（3000毫秒）发起一个呼叫</li>
<li>-inf data.csv：引入数据配置文件</li>
<li>-p 7098：本地端口（在xml脚本中用[local_port]引用）</li>
<li>-i 172.31.89.242：本地地址（在xml脚本中用[local_ip]引用）</li>
<li>-s 8001：被叫号码（在xml脚本中用[service]引用）</li>
<li>-sf uac_onecall.xml：引用xml脚本文件，根据需要模拟的呼叫流程编写</li>
<li>-sn uac :执行默认的uac流程，如需执行自己编写的流程文件，命令中应不含此参数</li>
<li>-m 1000:发送1000次呼叫后停止并退出。</li>
<li>-l 900 :最大同时保持呼叫量，默认值为3*caps值呼叫时长，当因种种原因导致现存呼叫总数达到此值时，SIPp将停止产生新的呼叫，等待现存呼叫总数低于此值时才继续产生呼叫。</li>
<li>-trace<em>err跟踪所有错误消息，并把错误消息保存到文件场景文件描述的 {fileName}\</em>{pid}_errors.log 文件中</li>
<li>-trace_screen 当程序结束时候打印统计信息并弹出屏幕（如果在后台运行的话）</li>
</ul>
<h2 id="使用SIPp对基于SIP协议的网络电话进行性能测试"><a href="#使用SIPp对基于SIP协议的网络电话进行性能测试" class="headerlink" title="使用SIPp对基于SIP协议的网络电话进行性能测试"></a>使用SIPp对基于SIP协议的网络电话进行性能测试</h2><h3 id="测试内容"><a href="#测试内容" class="headerlink" title="测试内容"></a>测试内容</h3><ul>
<li>测试某通信服务器在400组并发呼叫过程中的CPU负载峰值和内存占用率。</li>
</ul>
<h3 id="测试场景分析"><a href="#测试场景分析" class="headerlink" title="测试场景分析"></a>测试场景分析</h3><p>呼叫发起端：湖北省公安厅的两台测试机，每台测试机模拟出等量的电话终端，向十堰市公安局的物理电话机发起呼叫。<br>电话接收端：十堰市公安局的400台物理电话机。<br>网络环境：湖北省公安信息网。</p>
<p>测试环境的网络拓扑图如图4所示。</p>
<p>{: .center}<br><img src="/images/20140511201122_Network_Topology_Map.gif" alt="Network_Topology_Map"><br>图4 被测系统的网络拓扑图</p>
<h3 id="测试方法"><a href="#测试方法" class="headerlink" title="测试方法"></a>测试方法</h3><p>利用SIPp测试工具模拟电话终端，向物理电话机终端发起呼叫，保持呼叫16秒后，SIPp终止呼叫。<br>在测试过程中，通过命令的方式监控并记录通信服务器的CPU负载峰值和内存占用率。</p>
<h3 id="测试步骤"><a href="#测试步骤" class="headerlink" title="测试步骤"></a>测试步骤</h3><p>（1）配置SIPp测试工具：在湖北省公安厅的两台测试机上分别配置SIPp的场景文件（uacTest.xml，详见附录），数据文件（CallNumber.csv，详见附录）和测试控制文件（test.bat，详见附录）。<br>（2）开启通信服务器的资源监控：远程登录至十堰市公安局网络电话通信服务器，执行资源监控命令，开启对通信服务器CPU负载和内存的监控。<br>（3）执行测试：在湖北省公安厅的两台测试机上同时执行SIPp控制文件（bat文件）。<br>（4）获取测试结果：测试完毕后，导出被测通信服务器的资源监控结果，提取出并发测试期间中的资源监控结果。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li>电子工业出版社 计算机网络（第5版）谢希仁 编著。</li>
<li><a href="http://sipp.sourceforge.net/" target="_blank" rel="external">http://sipp.sourceforge.net/</a></li>
</ul>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><p>test.bat<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sipp -sf uac.xml -inf CallNumber.csv -i 10.XX.XX.151 -p 5061 -s 96018702 -m 1 -r 1 10.XX.XX.114:5060 -trace_err</div></pre></td></tr></table></figure></p>
<p>uacTest.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="ISO-8859-1" ?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE scenario SYSTEM "sipp.dtd"&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">scenario</span> <span class="attr">name</span>=<span class="string">"Basic Sipstone UAC"</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- In client mode (sipp placing calls), the Call-ID MUST be         --&gt;</span></div><div class="line">  <span class="comment">&lt;!-- generated by sipp. To do so, use [call_id] keyword.              --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">send</span> <span class="attr">retrans</span>=<span class="string">"500"</span>&gt;</span></div><div class="line">    &lt;![CDATA[</div><div class="line"></div><div class="line">      INVITE sip:[field0]@[remote_ip]:[remote_port] SIP/2.0</div><div class="line">      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]</div><div class="line">      From: "[service]" &lt;sip:[service]@[remote_ip]&gt;;tag=[call_number]</div><div class="line">      To: "[field0]" &lt;sip:[field0]@[remote_ip]&gt;</div><div class="line">      Call-ID: [call_id]</div><div class="line">      CSeq: 1 INVITE</div><div class="line">      Contact: sip:[service]@[local_ip]:[local_port]</div><div class="line">      Max-Forwards: 70</div><div class="line">      Subject: Performance Test</div><div class="line">      Content-Type: application/sdp</div><div class="line">      Content-Length: [len]</div><div class="line"></div><div class="line">      v=0</div><div class="line">      o=- 1 2 IN IP[local_ip_type] [local_ip]</div><div class="line">      s=-</div><div class="line">      c=IN IP[media_ip_type] [media_ip]</div><div class="line">      t=0 0</div><div class="line">      m=audio [media_port] RTP/AVP 0 8 18 101</div><div class="line">      a=rtpmap:18 G729/8000</div><div class="line"></div><div class="line">    ]]&gt;</div><div class="line">  <span class="tag">&lt;/<span class="name">send</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">recv</span> <span class="attr">response</span>=<span class="string">"100"</span> <span class="attr">optional</span>=<span class="string">"true"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">recv</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">recv</span> <span class="attr">response</span>=<span class="string">"180"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">recv</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- Set Ring Time   --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">pause</span> <span class="attr">milliseconds</span>=<span class="string">"8000"</span>/&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- Abort Call   --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">send</span> <span class="attr">retrans</span>=<span class="string">"500"</span>&gt;</span></div><div class="line">    &lt;![CDATA[</div><div class="line"></div><div class="line">      CANCEL sip:[field0]@[remote_ip]:[remote_port] SIP/2.0</div><div class="line">      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]</div><div class="line">      From: "[service]" &lt;sip:[service]@[remote_ip]&gt;;tag=[call_number]</div><div class="line">      To: "[field0]" &lt;sip:[field0]@[remote_ip]&gt;</div><div class="line">      Call-ID: [call_id]</div><div class="line">      CSeq: 1 CANCEL</div><div class="line"></div><div class="line">    ]]&gt;</div><div class="line">  <span class="tag">&lt;/<span class="name">send</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- By adding rrs="true" (Record Route Sets), the route sets         --&gt;</span></div><div class="line">  <span class="comment">&lt;!-- are saved and used for following messages sent. Useful to test   --&gt;</span></div><div class="line">  <span class="comment">&lt;!-- against stateful SIP proxies/B2BUAs.                             --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">recv</span> <span class="attr">response</span>=<span class="string">"200"</span> <span class="attr">rtd</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">recv</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- Packet lost can be simulated in any send/recv message by         --&gt;</span></div><div class="line">  <span class="comment">&lt;!-- by adding the 'lost = "10"'. Value can be [1-100] percent.       --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">send</span>&gt;</span></div><div class="line">    &lt;![CDATA[</div><div class="line"></div><div class="line">      ACK sip:[service]@[remote_ip]:[remote_port] SIP/2.0</div><div class="line">      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]</div><div class="line">      From: sipp &lt;sip:sipp@[local_ip]:[local_port]&gt;;tag=[call_number]</div><div class="line">      To: sut &lt;sip:[service]@[remote_ip]:[remote_port]&gt;[peer_tag_param]</div><div class="line">      Call-ID: [call_id]</div><div class="line">      CSeq: 1 ACK</div><div class="line">      Contact: sip:sipp@[local_ip]:[local_port]</div><div class="line">      Max-Forwards: 70</div><div class="line">      Subject: Performance Test</div><div class="line">      Content-Length: 0</div><div class="line"></div><div class="line">    ]]&gt;</div><div class="line">  <span class="tag">&lt;/<span class="name">send</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- This delay can be customized by the -d command-line option       --&gt;</span></div><div class="line">  <span class="comment">&lt;!-- or by adding a 'milliseconds = "value"' option here.             --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">pause</span> <span class="attr">milliseconds</span>=<span class="string">"8000"</span>/&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- The 'crlf' option inserts a blank line in the statistics report. --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">send</span> <span class="attr">retrans</span>=<span class="string">"500"</span>&gt;</span></div><div class="line">    &lt;![CDATA[</div><div class="line"></div><div class="line">      BYE sip:[service]@[remote_ip]:[remote_port] SIP/2.0</div><div class="line">      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]</div><div class="line">      From: sipp &lt;sip:sipp@[local_ip]:[local_port]&gt;;tag=[call_number]</div><div class="line">      To: sut &lt;sip:[service]@[remote_ip]:[remote_port]&gt;[peer_tag_param]</div><div class="line">      Call-ID: [call_id]</div><div class="line">      CSeq: 2 BYE</div><div class="line">      Contact: sip:sipp@[local_ip]:[local_port]</div><div class="line">      Max-Forwards: 70</div><div class="line">      Subject: Performance Test</div><div class="line">      Content-Length: 0</div><div class="line"></div><div class="line">    ]]&gt;</div><div class="line">  <span class="tag">&lt;/<span class="name">send</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">recv</span> <span class="attr">response</span>=<span class="string">"200"</span> <span class="attr">crlf</span>=<span class="string">"true"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">recv</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- definition of the response time repartition table (unit is ms)   --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">ResponseTimeRepartition</span> <span class="attr">value</span>=<span class="string">"10, 20, 30, 40, 50, 100, 150, 200"</span>/&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- definition of the call length repartition table (unit is ms)     --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">CallLengthRepartition</span> <span class="attr">value</span>=<span class="string">"10, 50, 100, 500, 1000, 5000, 10000"</span>/&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">scenario</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>CallNumber.csv<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">SEQUENTIAL</div><div class="line">96038000;</div><div class="line">96038001;</div><div class="line">96038002;</div><div class="line">......</div></pre></td></tr></table></figure></p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/性能测试/">性能测试</a><a href="/tags/SIP/">SIP</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://debugtalk.com/post/SIPp-IP-Telephone-Server-Performance-Testing/" data-title="使用SIPp对基于SIP协议的IP电话通信服务器进行性能测试 | DebugTalk" data-tsina="undefined" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/post/Introspection-on-WebService-Test/" title="基于WSDL或SOAP的WebService测试方法--对原理的思考">
  <strong>上一篇：</strong><br/>
  <span>
  基于WSDL或SOAP的WebService测试方法--对原理的思考</span>
</a>
</div>


<div class="next">
<a href="/post/loadrunner-get-system-time/"  title="LoadRunner中获取当前系统时间">
 <strong>下一篇：</strong><br/> 
 <span>LoadRunner中获取当前系统时间
</span>
</a>
</div>

</nav>

	

<section id="comments" class="comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#背景知识介绍"><span class="toc-number">1.</span> <span class="toc-text">背景知识介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IP电话"><span class="toc-number">1.1.</span> <span class="toc-text">IP电话</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IP电话网关"><span class="toc-number">1.2.</span> <span class="toc-text">IP电话网关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IP电话所需要的几种应用协议"><span class="toc-number">1.3.</span> <span class="toc-text">IP电话所需要的几种应用协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SIP协议"><span class="toc-number">1.4.</span> <span class="toc-text">SIP协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SIPp工具介绍"><span class="toc-number">2.</span> <span class="toc-text">SIPp工具介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SIPp软件简介"><span class="toc-number">2.1.</span> <span class="toc-text">SIPp软件简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SIPp的安装（Windows）"><span class="toc-number">2.2.</span> <span class="toc-text">SIPp的安装（Windows）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SIPp的工作原理"><span class="toc-number">2.3.</span> <span class="toc-text">SIPp的工作原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SIPp的常用工作模式"><span class="toc-number">2.4.</span> <span class="toc-text">SIPp的常用工作模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SIPp的使用"><span class="toc-number">3.</span> <span class="toc-text">SIPp的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SIPp的配置文件"><span class="toc-number">3.1.</span> <span class="toc-text">SIPp的配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uac-xml"><span class="toc-number">3.2.</span> <span class="toc-text">uac.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#data-csv"><span class="toc-number">3.3.</span> <span class="toc-text">data.csv</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uac-bat"><span class="toc-number">3.4.</span> <span class="toc-text">uac.bat</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用SIPp对基于SIP协议的网络电话进行性能测试"><span class="toc-number">4.</span> <span class="toc-text">使用SIPp对基于SIP协议的网络电话进行性能测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#测试内容"><span class="toc-number">4.1.</span> <span class="toc-text">测试内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试场景分析"><span class="toc-number">4.2.</span> <span class="toc-text">测试场景分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试方法"><span class="toc-number">4.3.</span> <span class="toc-text">测试方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试步骤"><span class="toc-number">4.4.</span> <span class="toc-text">测试步骤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考资料"><span class="toc-number">5.</span> <span class="toc-text">参考资料</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#附录"><span class="toc-number">6.</span> <span class="toc-text">附录</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github Card</p>
<div class="github-card" data-github="debugtalk" data-width="220" data-height="119" data-theme="medium">
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>
  </div>



  

  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/HttpRunner/" title="HttpRunner">HttpRunner<sup>20</sup></a></li>
			
		
			
				<li><a href="/tags/Android/" title="Android">Android<sup>12</sup></a></li>
			
		
			
				<li><a href="/tags/AutomationTest/" title="AutomationTest">AutomationTest<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/LoadRunner/" title="LoadRunner">LoadRunner<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/Appium/" title="Appium">Appium<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/iOS/" title="iOS">iOS<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/测试框架/" title="测试框架">测试框架<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/Jenkins/" title="Jenkins">Jenkins<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/自动化测试/" title="自动化测试">自动化测试<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Locust/" title="Locust">Locust<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/环境搭建/" title="环境搭建">环境搭建<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/WebService/" title="WebService">WebService<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/F0T1/" title="F0T1">F0T1<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/招聘/" title="招聘">招聘<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/性能测试/" title="性能测试">性能测试<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/个人成长/" title="个人成长">个人成长<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/SOAP/" title="SOAP">SOAP<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/CI/" title="CI">CI<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/WSDL/" title="WSDL">WSDL<sup>3</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Recent GitHub Projects</p>
    <ul>
        
          <li>
            
            	<a href="https://github.com/HttpRunner/HttpRunner" target="_blank" title="HttpRunner">HttpRunner</a>
            
          </li>
        
          <li>
            
            	<a href="https://github.com/HttpRunner/har2case" target="_blank" title="har2case">har2case</a>
            
          </li>
        
          <li>
            
            	<a href="https://github.com/debugtalk/WebCrawler" target="_blank" title="WebCrawler">WebCrawler</a>
            
          </li>
        
          <li>
            
            	<a href="https://github.com/debugtalk/AppiumBooster" target="_blank" title="AppiumBooster">AppiumBooster</a>
            
          </li>
        
          <li>
            
            	<a href="https://github.com/debugtalk/JenkinsTemplateForApp" target="_blank" title="JenkinsTemplateForApp">JenkinsTemplateForApp</a>
            
          </li>
        
    </ul>
</div>

  <div class="weixin">
  <br />
  <p class="asidetitle">微信公众号</p>
  <p>欢迎关注「DebugTalk」，获取本站最新内容。</p>
  <img src="/images/wechat_qrcode.png" width="230px" />
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	

  
			
		

		<p class="copyright" style="margin-top: 8px;">
		<a href="http://hexo.io" target="_blank" title="hexo">Hexo</a> & <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2018
		
		<a href="/about" target="_blank" title="九毫">九毫</a>
		

    <!-- Analytics Begin -->
    
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-81639610-1', 'auto');
ga('send', 'pageview');
</script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?96dc81023a24bbe64c8bfd8aff39582d";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>





<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>



<script>
(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();
</script>


    <!-- Analytics End -->

    
    <span id="busuanzi_container_site_pv">
      # 本站总访问量<span id="busuanzi_value_site_pv"></span>次
    </span>
    
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
      
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});
</script>




<script type="text/javascript">

var disqus_shortname = 'debugtalk';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>








<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
